---
title: 스핀락, 분산락
date: 2022-10-26T15:12:26+09:00
categories:
  - system
tags: 
  - spin-lock
  - distributed-lock
---

## 스핀 락 (Spin lock)

바쁜 대기의 개념을 이용한 락으로, 임계 구역(critical section)에 진입이 불가능할 때 **진입이 가능할 때까지 루프를 돌면서 재시도**하는 방식으로 구현된 락이다. 

스핀락이라는 이름은 락을 획득할 때까지 해당 스레드가 빙빙 돌고 있다(spinning)는 것에서 유래한다.

뮤텍스 락과의 차이점은 락을 얻을 수 없을때 스레드 슬립 모드로 빠지지 않고, 반복문을 계속 돌며 락을 얻으려는 시도를 한다는 것으로, 락이 해제될 때 별도의 스레드 문맥교환(context switching)에 대한 오버헤드 없이 임계구역에 접근을 한다는 점이다.

뮤텍스 락의 경우, 락이 해제되더라도 운영체제에 의해 스레드가 다시 깨어나야하지만, 스핀락은 락을 얻을때까지 계속해서 CPU 자원을 점유하므로 **CPU를 비효율적으로 낭비할 위험**이 있다. 그러므로, **임계구역 진입을 위한 대기시간이 짧을 때 사용하는게 바람직**하다.

## 분산 락 (Distributed lock)

서버가 여러 대인 상황에서 동일한 데이터에 대한 동기화를 보장하기 위해 사용하는 락이다.

서버가 한대가 아니라 여러 대인 경우 여러 서버로 API가 분산 호출 된다. **서버들간에 동기화된 처리가 필요하고, 여러 서버에 공통된 락을 적용**해야 하기 때문에 Redis 등을 이용하여 분산락을 구현한다.

분산락 같은 경우 **DB 등 공통된 데이터 저장소를 이용해 자원이 사용중인지 확인**하기 때문에 전체 서버에 동기화된 처리가 가능 하다.

## 참고
https://zepeh.tistory.com/180

https://goodgid.github.io/Spin-Lock/

https://soyeon207.github.io/db/2021/08/29/distributed-lock.html#h-%EB%B6%84%EC%82%B0%EB%9D%BD-distributed-lock
